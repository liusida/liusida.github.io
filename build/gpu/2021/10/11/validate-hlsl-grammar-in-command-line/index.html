<!DOCTYPE html> <html lang=" en "><head> <meta charset="utf-8"> <title>Validate HLSL grammar in command line</title> <meta http-equip="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="description" content="Validate HLSL grammar in command line" /> <meta name="keywords" content="Validate HLSL grammar in command line, Sida Liu, GPU" /> <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml"> <meta content="" property="fb:app_id"> <meta content="Sida Liu" property="og:site_name"> <meta content="Validate HLSL grammar in command line" property="og:title"> <meta content="article" property="og:type"> <meta content="HLSL is used in Unity, and one can debug HLSL code in SHADERed. However, SHADERed doesn't show the detailed compile error message as Unity does. Here we show how to use a tool called glslangValidator to validate the HLSL grammar in command line." property="og:description"> <meta content="https://liusida.github.io/gpu/2021/10/11/validate-hlsl-grammar-in-command-line/" property="og:url"> <meta content="2021-10-11T00:00:00+08:00" property="article:published_time"> <meta content="https://liusida.github.io/about/" property="article:author"> <meta content="GPU" property="article:section"> <meta name="twitter:card" content="summary"> <meta name="twitter:site" content="@"> <meta name="twitter:creator" content="@"> <meta name="twitter:title" content="Validate HLSL grammar in command line"> <meta content="Sida Liu" property="og:site_name"> <meta name="twitter:url" content="https://liusida.github.io/gpu/2021/10/11/validate-hlsl-grammar-in-command-line/"> <meta name="twitter:description" content="The world is so complex that we cannot stop learning."> <link rel="stylesheet" href="/assets/css/main.css" /> <!-- <link rel="stylesheet" href="/assets/css/custom-style.css" /> --> <link rel="stylesheet" href="/assets/bower_components/lightgallery/dist/css/lightgallery.min.css"/> <!-- <link rel="stylesheet" href="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.css" /> --> <!-- <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.css"> --> <!-- <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch-theme-algolia.min.css"> --> <link rel="stylesheet" href="/assets/bower_components/bootstrap/dist/css/bootstrap.min.css" /> <link rel="stylesheet" href="/assets/bower_components/font-awesome/web-fonts-with-css/css/fontawesome-all.min.css" /> <link rel="stylesheet" href="/assets/bower_components/icono/dist/icono.min.css"/> <!-- Fonts--> <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet"> <!-- Favicon --> <link rel="icon" href="https://liusida.github.io/assets/img/favicon.ico" type="image/gif" sizes="16x16"> <!-- Jquery --> <script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha384-vk5WoKIaW/vJyUAd9n/wmopsmNhiy+L2Z+SBxGYnUkunIxVxAv/UtMOhba/xskxh" crossorigin="anonymous"></script> <!-- <script src="/assets/bower_components/jquery/dist/jquery.min.js"></script> --> <script src="/assets/bower_components/jquery.easing/jquery.easing.min.js"></script> <script src="/assets/bower_components/bootstrap/dist/js/bootstrap.bundle.min.js"></script> <script src="/assets/bower_components/jquery-mousewheel/jquery.mousewheel.min.js"></script> <script src="/assets/bower_components/lightgallery/dist/js/lightgallery-all.min.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/picturefill/3.0.2/picturefill.min.js"></script> <script src="/assets/bower_components/imagesloaded/imagesloaded.pkgd.min.js"></script> <script src="/assets/bower_components/nanobar/nanobar.min.js"></script> <script src="/assets/bower_components/typewrite/dist/typewrite.min.js"></script> <!-- <script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.6.0/dist/instantsearch.min.js"></script> --> <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script> <!-- Github Button --> <script async defer src="https://buttons.github.io/buttons.js"></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script> </head><body> <nav class="navbar navbar-expand-lg fixed-top navbar-dark" id="topNav"> <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" > <span class="icono-hamburger" id="navbar-hamburger"> </span> </button> <a class="navbar-brand" href="/">Sida Liu</a> <div class="collapse navbar-collapse" id="navbarNav"> <ul class="navbar-nav"> <li class="nav-item"> <a class="nav-link" href="https://liusida.github.io/cover" >Cover</a > </li> <li class="nav-item"> <a class="nav-link" href="https://liusida.github.io/blog" >Blog</a > </li> <li class="nav-item"> <a class="nav-link" href="https://liusida.github.io/contact" >Contact Me</a > </li> </ul> </div> <ul class="nav justify-content-end"> <!-- <li class="nav-item"> <a class="nav-link" id="search-icon" href="https://liusida.github.io/search#/" ><i class="fa fa-search" aria-hidden="true"></i ></a> </li> <li class="nav-item"> <input class="nav-link switch" id="theme-toggle" onclick="modeSwitcher() " type="checkbox" name="checkbox" /> </li> --> </ul> </nav> <div class="col-lg-12"> <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script> <div class="row" id="blog-post-container"> <div class="col-lg-8 offset-md-2"><article class="card" itemscope itemtype="http://schema.org/BlogPosting"> <div class="card-header"> <h1 class="post-title" itemprop="name headline">Validate HLSL grammar in command line</h1> <h4 class="post-meta">HLSL is used in Unity, and one can debug HLSL code in SHADERed. However, SHADERed doesn't show the detailed compile error message as Unity does. Here we show how to use a tool called glslangValidator to validate the HLSL grammar in command line.</h4> <p class="post-summary"> Posted by : (<time datetime="2021-10-11 00:00:00 +0800" itemprop="datePublished" >Oct 11, 2021</time >) </p> <span class="disqus-comment-count" data-disqus-identifier="/gpu/2021/10/11/validate-hlsl-grammar-in-command-line/" ></span> <div class="post-categories"> Category : <a href="/blog/categories/GPU" >GPU</a > </div> </div> <div class="card-body" itemprop="articleBody"> <!-- <img class="card-img-top" src="https://liusida.github.io/assets/img/posts/" alt="" /> --> <p>HLSL, a.k.a. High-level shader language, is used in Unity.</p> <p>One can write the shader in Unity (with VS or VSCode) and compile it automatically in Unity. If there’s any error in the shader code, the error message will show up in the Unity console.</p> <p>However, since I am using a Linux, I can’t debug the shader in Unity. So I turn to a light-weight tool called SHADERed. One can install the SHADERed plug-in in VSCode along with SHADERed, and voilà, we can debug the shader code!</p> <p>So we can write HLSL in VSCode and SHADERed first, and then copy it to Unity shader and modify it to be compatible.</p> <p>Here is a cool video shows how to do the modification, it even works with GLSL. <a href="https://www.youtube.com/watch?v=CzORVWFvZ28">Youtube: How to convert a shader from ShaderToy to Unity</a></p> <p>Now my problem was that SHADERed won’t show the detailed compilation error if there’s any error in the shader code. It just says, “Can not display preview - there are some errors you should fix.”</p> <p>So I digged in a bit, and realized that both Unity and SHADERed use <a href="https://github.com/KhronosGroup/glslang">glslang</a> to compile the shader code.</p> <p>Luckily, glslang provide a standalone executable that can compile the shader code as a showcase of how to use the glslang API. It is called <code class="highlighter-rouge">glslangValidator</code>. I am on Ubuntu, so I can get this tool by simply <code class="highlighter-rouge">apt install glslang-tools</code>.</p> <p>So for example we want to validate this piece of fragment shader named <code class="highlighter-rouge">2d_SimplePS.hlsl</code>:</p> <div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">cbuffer</span> <span class="n">vars</span> <span class="o">:</span> <span class="k">register</span><span class="p">(</span><span class="n">b0</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">float2</span> <span class="n">uResolution</span><span class="p">;</span>
	<span class="kt">float</span> <span class="n">uTime</span><span class="p">;</span>
<span class="p">};</span>

<span class="n">float4</span> <span class="n">main</span><span class="p">(</span><span class="n">float4</span> <span class="n">fragCoord</span> <span class="o">:</span> <span class="n">SV_POSITION</span><span class="p">)</span> <span class="o">:</span> <span class="n">SV_TARGET</span>
<span class="p">{</span>
    <span class="n">float2</span> <span class="n">uv</span> <span class="o">=</span> <span class="n">fragCoord</span><span class="p">.</span><span class="n">xy</span><span class="o">/</span><span class="n">uResolution</span><span class="p">;</span>
    <span class="n">uv</span> <span class="o">-=</span> <span class="p">.</span><span class="mi">5</span><span class="p">;</span>
    <span class="n">uv</span> <span class="o">*=</span> <span class="n">uResolution</span><span class="p">.</span><span class="n">x</span><span class="o">/</span><span class="n">uResolution</span><span class="p">.</span><span class="n">y</span><span class="p">;</span>
    <span class="n">here</span> <span class="n">is</span> <span class="n">an</span> <span class="n">intentional</span> <span class="n">error</span><span class="p">;</span>
    <span class="n">float4</span> <span class="n">color</span> <span class="o">=</span> <span class="n">float4</span><span class="p">(</span><span class="n">uv</span><span class="p">.</span><span class="n">x</span><span class="p">,</span> <span class="n">uv</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
    <span class="k">return</span> <span class="n">color</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div> <p>And we use the command:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># look it up using `man glslangValidator`</span>
glslangValidator <span class="nt">-S</span> frag <span class="nt">-D</span> <span class="nt">--client</span> vulkan100 <span class="nt">-e</span> frag 2d_SimplePS.hlsl
</code></pre></div></div> <p>and the compiler will show the error message:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2d_SimplePS.hlsl
ERROR: 2d_SimplePS.hlsl:12: <span class="s1">'here'</span> : unknown variable 
ERROR: 2d_SimplePS.hlsl:12: <span class="s1">';'</span> : Expected 
2d_SimplePS.hlsl<span class="o">(</span>12<span class="o">)</span>: error at column 11, HLSL parsing failed.
ERROR: 3 compilation errors.  No code generated.

SPIR-V is not generated <span class="k">for </span>failed compile or <span class="nb">link</span>
</code></pre></div></div> <p>We have the file name, line number, and the detailed error messages. Great!</p> </div><!-- Incomment incase you want to use Disqus <div id="disqus_thread"></div> --> </article> <script> var disqus_config = function () { this.page.url = "https://liusida.github.io/gpu/2021/10/11/validate-hlsl-grammar-in-command-line/"; /* Replace PAGE_URL with your page's canonical URL variable */ this.page.identifier = "/gpu/2021/10/11/validate-hlsl-grammar-in-command-line"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */ }; (function () { /* DON'T EDIT BELOW THIS LINE */ var d = document, s = d.createElement('script'); s.src = 'https://.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a> </noscript></div> </div> <div class="row"> <div class="col-md-4"> <div class="card"> <div class="card-header">About Sida Liu</div> <div class="card-body"> <p class="author_bio">I am currently a M.S. graduate student in Morphology, Evolution & Cognition Laboratory at University of Vermont. I am interested in artificial intelligence, artificial life, and artificial environment.</p><!-- Place this tag where you want the button to render. --> <a class="github-button" href="https://github.com/liusida" data-size="large" data-show-count="true" aria-label="Follow @liusida on GitHub">Follow @liusida</a></div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Categories</div> <div class="card-body text-dark"> <div id="#Old"></div> <li class="tag-head"> <a href="/blog/categories/Old">Old</a> </li> <a name="Old"></a> <div id="#CUDA"></div> <li class="tag-head"> <a href="/blog/categories/CUDA">CUDA</a> </li> <a name="CUDA"></a> <div id="#Simulation"></div> <li class="tag-head"> <a href="/blog/categories/Simulation">Simulation</a> </li> <a name="Simulation"></a> <div id="#GPU"></div> <li class="tag-head"> <a href="/blog/categories/GPU">GPU</a> </li> <a name="GPU"></a> <div id="#Reading"></div> <li class="tag-head"> <a href="/blog/categories/Reading">Reading</a> </li> <a name="Reading"></a> <div id="#Coding"></div> <li class="tag-head"> <a href="/blog/categories/Coding">Coding</a> </li> <a name="Coding"></a> </div> </div> </div> <div class="col-md-4"> <div class="card"> <div class="card-header">Useful Links</div> <div class="card-body text-dark"> <li> <a href="https://liusida.github.io/cover">Cover</a> </li> <li> <a href="https://liusida.github.io/blog">Blog</a> </li> <li> <a href="https://liusida.github.io/contact">Contact Me</a> </li> </div> </div> </div> </div> </div><footer> <p> Powered by <strong>devlopr jekyll</strong>. Subscribe via <a href=" /feed.xml ">RSS</a> </p> </footer> <script> var options = { classname: 'my-class', id: 'my-id' }; var nanobar = new Nanobar( options ); nanobar.go( 30 ); nanobar.go( 76 ); nanobar.go(100); </script> <!-- <div hidden id="snipcart" data-api-key="Y2I1NTAyNWYtMTNkMy00ODg0LWE4NDItNTZhYzUxNzJkZTI5NjM3MDI4NTUzNzYyMjQ4NzU0"></div> --> <!-- <script src="https://cdn.snipcart.com/themes/v3.0.0-beta.3/default/snipcart.js" defer></script> --> <!-- <script src="/assets/js/mode-switcher.js"></script> --> </body> </html>
